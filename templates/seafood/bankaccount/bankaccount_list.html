{% extends "layouts/base.html" %}
{% load static %}

{% block title %}Liste des Comptes Bancaires{% endblock %}

{% block content %}

<div class="mb-2">
  <div class="row align-items-center justify-content-between g-3 mb-4">
    <div class="col-auto">
      <h2 class="mb-0">LISTE DES COMPTES BANCAIRES</h2>
    </div>
    <div class="col-auto">
      <a href="{% url 'portal_admin:bankaccount_add' %}" class="btn btn-primary">
        <span class="fas fa-plus me-2"></span>Ajouter un compte
      </a>
    </div>
  </div>

  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  {% endif %}

 
  <div id="orderTable" data-list='{"valueNames":["order","total","customer","payment_status","fulfilment_status","delivery_type","date"],"page":10,"pagination":true}'>
    <div class="mx-n4 px-4 mx-lg-n6 px-lg-6 bg-body-emphasis border-top border-bottom border-translucent position-relative top-1">
      <div class="table-responsive scrollbar mx-n1 px-1">
        <table class="table table-sm fs-9 mb-0">
          <thead>
            <tr>
              <th class="white-space-nowrap fs-9 align-middle ps-0">
                <div class="form-check mb-0 fs-8">
                  <input class="form-check-input" id="checkbox-bulk-order-select" type="checkbox" data-bulk-select='{"body":"order-table-body"}' />
                </div>
              </th>
              <th class="sort align-middle" scope="col" data-sort="order">IDENTIFIANT</th>
              <th class="sort align-middle" scope="col" data-sort="total" >BANQUE</th>
              <th class="sort align-middle" scope="col" data-sort="customer">N° COMPTE</th>
              <th class="sort align-middle" scope="col" data-sort="date">STATUT</th>
              <th class="sort align-middle" scope="col" data-sort="payment_status" >TYPE</th>
              <th class="sort align-middle" scope="col" data-sort="fulfilment_status">DEVISE</th>
              <th class="sort align-middle text-end" scope="col" data-sort="delivery_type" >SOLDE</th>
              <th class="sort align-middle text-end" scope="col" data-sort="delivery_type" >ACTIONS</th>
            </tr>
          </thead>
          <tbody class="list" id="order-table-body">

            {% for account in bankaccounts %}

              <tr class="hover-actions-trigger btn-reveal-trigger position-static">
                <td class="fs-9 align-middle px-0 py-3">
                  <div class="form-check mb-0 fs-8">
                    <input class="form-check-input" type="checkbox" data-bulk-select-row='{"order":2453,"total":87,"customer":{"avatar":"/team/32.webp","name":"Carry Anna"},"payment_status":{"label":"Complete","type":"badge-phoenix-success","icon":"check"},"fulfilment_status":{"label":"Cancelled","type":"badge-phoenix-secondary","icon":"x"},"delivery_type":"Cash on delivery","date":"Dec 12, 12:56 PM"}' />
                  </div>
                </td>
                <td class="order align-middle">
                  <a class="fw-semibold" href="{% url 'portal_admin:bankaccount_detail' account.pk %}">#{{ account.bank_identifier }}</a>
                </td>
                <td class="total align-middle fw-semibold text-body-highlight">
                  {{ account.bank_name }}
                  {% if account.agency %}<br><small class="text-muted">{{ account.agency }}</small>{% endif %}
                </td>
                <td class="customer align-middle">
                  <h6 class="text-body">{{ account.account_number }}</h6>
                </td>
                <td class="delivery_type align-middle fs-9">
                  {% if account.status == 'active' %}
                    <span class="badge badge-phoenix fs-10 badge-phoenix-success"><span class="badge-label">{{ account.get_status_display }}</span><span class="ms-1" data-feather="check" style="height:12.8px;width:12.8px;"></span></span>
                  {% elif account.status == 'inactive' %}
                    <span class="badge badge-phoenix fs-10 badge-phoenix-danger"><span class="badge-label">{{ account.get_status_display }}</span><span class="ms-1" data-feather="x" style="height:12.8px;width:12.8px;"></span></span>
                  {% elif account.status == 'closed' %}
                    <span class="badge badge-phoenix fs-10 badge-phoenix-dark"><span class="badge-label">{{ account.get_status_display }}</span><span class="ms-1" data-feather="x" style="height:12.8px;width:12.8px;"></span></span>
                  {% else %}
                    <span class="badge badge-phoenix fs-10 badge-phoenix-warning"><span class="badge-label">{{ account.get_status_display }}</span><span class="ms-1" data-feather="x" style="height:12.8px;width:12.8px;"></span></span>
                  {% endif %}
                </td>
                <td class="payment_status align-middle fw-bold">
                  <span class="badge bg-secondary fs-10">{{ account.get_account_type_display }}</span>
                </td>
                <td class="fulfilment_status align-middle fw-bold">
                  <span class="badge bg-primary fs-10">{{ account.currency }}</span>
                </td>
                <td class="date align-middle fw-bold fs-8 text-end">{{ account.current_balance|floatformat:2 }}</td>
              
                <td class="actions align-middle white-space-nowrap text-end">
                  <a href="{% url 'portal_admin:bankaccount_detail' account.pk %}" title="Détails"><span class="text-body fs-5" data-feather="eye"></span></a>
                  <a href="{% url 'portal_admin:bankaccount_edit' account.pk %}" title="Modifier"><span class="text-body fs-5" data-feather="edit"></span></span></a>
                  <a href="{% url 'portal_admin:bankaccount_delete' account.pk %}" title="Supprimer"><span class="text-body fs-5" data-feather="trash-2"></span></span></a>
                </td>
              </tr>
              
            {% empty %}
              <tr>
                <td colspan="8" class="text-center py-4">
                  <p class="text-muted mb-0">Aucun compte bancaire trouvé</p>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

{% endblock %}
